#!/bin/bash

if [[ "$OS" == "MINGW"* || "$OS" == "Windows_NT"* ]]; then
    PATH="$PWD/build/bin/:$PATH"
    export PATH
fi

cd build

test_arg="$1"

if [[ -z "$test_arg" || "$test_arg" == "--all" ]]; then
    ctest .
elif [[ "$test_arg" == "--Common" ]]; then
    ctest -R "(ASTTest|LoggerTest|FileManagerTest|SemanticAnalyzerTest|RetranslatorTest|FiguresStorageTest)" .
elif [[ "$test_arg" == "--Backend" ]]; then
    ctest -R BackendTest
elif [[ "$test_arg" == "--AST" ]]; then
    ctest -R ASTTest
elif [[ "$test_arg" == "--Logger" ]]; then
    ctest -R LoggerTest
elif [[ "$test_arg" == "--FileManager" ]]; then
    ctest -R FileManagerTest
elif [[ "$test_arg" == "--SA" ]]; then
    ctest -R SemanticAnalyzerTest
elif [[ "$test_arg" == "--Retranslator" ]]; then
    ctest -R RetranslatorTest
elif [[ "$test_arg" == "--FiguresStorage" ]]; then
    ctest -R FiguresStorageTest
else
    echo "Usage: $0 [--all | --Common | --Backend | --AST | --Logger | --FileManager | --SA | --Retranslator | --FiguresStorage]" >&2
    exit 1
fi

echo "Тесты завершены."
